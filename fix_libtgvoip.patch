From 28e80ce3b5f63ce9e5bf41136e5b2413e50d1ea4 Mon Sep 17 00:00:00 2001
From: Vitaly Zaitsev <vitaly@easycoding.org>
Date: Thu, 6 Jul 2017 17:27:01 +0200
Subject: [PATCH] Fixed build of libtgvoip under Fedora as shared library.

---
 libtgvoip.gyp | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/libtgvoip.gyp b/libtgvoip.gyp
index 52fbea1..e3dc413 100644
--- a/libtgvoip.gyp
+++ b/libtgvoip.gyp
@@ -4,7 +4,8 @@
     'targets': [
       {
         'target_name': 'libtgvoip',
-        'type': 'static_library',
+        'type': 'shared_library',
+        'product_extension': 'so.<!(echo -n "$VOIPVER")',
         'dependencies': [],
         'defines': [
           'WEBRTC_APM_DEBUG_DUMP=0',
@@ -13,11 +14,11 @@
         'variables': {
           'tgvoip_src_loc': '.',
           'official_build_target%': '',
-          'linux_path_opus_include%': '<(DEPTH)/../../../Libraries/opus/include',
         },
         'include_dirs': [
           '<(tgvoip_src_loc)/webrtc_dsp',
-          '<(linux_path_opus_include)',
+          '<!(rpm --eval "%{_includedir}")',
+          '<!(rpm --eval "%{_includedir}/opus")',
         ],
         'direct_dependent_settings': {
           'include_dirs': [
-- 
2.9.4

