From 8d4c4f7787ae2a5680e907d2e9fac050ab0c1a99 Mon Sep 17 00:00:00 2001
From: Vitaly Zaitsev <vitaly@easycoding.org>
Date: Wed, 8 Mar 2017 15:05:55 +0100
Subject: [PATCH] Use correct build flags for Fedora.

---
 Telegram/gyp/settings_linux.gypi | 23 +++++------------------
 Telegram/gyp/telegram_linux.gypi | 11 +++--------
 2 files changed, 8 insertions(+), 26 deletions(-)

diff --git a/Telegram/gyp/settings_linux.gypi b/Telegram/gyp/settings_linux.gypi
index 4cdf7a5..dea8480 100644
--- a/Telegram/gyp/settings_linux.gypi
+++ b/Telegram/gyp/settings_linux.gypi
@@ -21,22 +21,6 @@
   'conditions': [
     [ 'build_linux', {
       'variables': {
-        'linux_common_flags': [
-          '-pipe',
-          '-g',
-          '-Wall',
-          '-W',
-          '-fPIC',
-          '-Wno-unused-result',
-          '-Wno-unused-variable',
-          '-Wno-unused-parameter',
-          '-Wno-unused-function',
-          '-Wno-switch',
-          '-Wno-comment',
-          '-Wno-unused-but-set-variable',
-          '-Wno-missing-field-initializers',
-          '-Wno-sign-compare',
-        ],
       },
       'conditions': [
         [ '"<!(uname -p)" == "x86_64"', {
@@ -65,13 +49,16 @@
         'QT_PLUGIN',
       ],
       'cflags_c': [
-        '<@(linux_common_flags)',
+        '<!(echo $CFLAGS)',
         '-std=gnu11',
       ],
       'cflags_cc': [
-        '<@(linux_common_flags)',
+        '<!(echo $CXXFLAGS)',
         '-std=gnu++14',
       ],
+      'ldflags': [
+        '<!(echo $LDFLAGS)',
+       ],
       'configurations': {
         'Debug': {
         },
diff --git a/Telegram/gyp/telegram_linux.gypi b/Telegram/gyp/telegram_linux.gypi
index 414eee0..85f5788 100644
--- a/Telegram/gyp/telegram_linux.gypi
+++ b/Telegram/gyp/telegram_linux.gypi
@@ -85,18 +85,13 @@
     'configurations': {
       'Release': {
         'cflags': [
-          '-Ofast',
-          '-flto',
-          '-fno-strict-aliasing',
+          '<!(echo $CFLAGS)',
         ],
         'cflags_cc': [
-          '-Ofast',
-          '-flto',
-          '-fno-strict-aliasing',
+          '<!(echo $CXXFLAGS)',
         ],
         'ldflags': [
-          '-Ofast',
-          '-flto',
+          '<!(echo $LDFLAGS)',
         ],
       },
     },
-- 
2.9.3

