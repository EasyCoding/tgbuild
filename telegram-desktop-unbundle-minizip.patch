From 2bf6893a761b28909bb00589e04975f507075c91 Mon Sep 17 00:00:00 2001
From: Vitaly Zaitsev <vitaly@easycoding.org>
Date: Wed, 17 Oct 2018 17:57:59 +0200
Subject: [PATCH 4/4] Use packaged version of minizip on Fedora <= 29.

---
 Telegram/gyp/Telegram.gyp         | 2 --
 Telegram/gyp/telegram_linux.gypi  | 2 ++
 Telegram/gyp/telegram_sources.txt | 7 -------
 3 files changed, 2 insertions(+), 9 deletions(-)

diff --git a/Telegram/gyp/Telegram.gyp b/Telegram/gyp/Telegram.gyp
index db904453e..d92e36b79 100644
--- a/Telegram/gyp/Telegram.gyp
+++ b/Telegram/gyp/Telegram.gyp
@@ -18,7 +18,6 @@
       'src_loc': '../SourceFiles',
       'res_loc': '../Resources',
       'submodules_loc': '../ThirdParty',
-      'minizip_loc': '<(submodules_loc)/minizip',
       'sp_media_key_tap_loc': '<(submodules_loc)/SPMediaKeyTap',
       'emoji_suggestions_loc': '<(submodules_loc)/emoji_suggestions',
       'style_files': [
@@ -91,7 +90,6 @@
     'include_dirs': [
       '<(src_loc)',
       '<(SHARED_INTERMEDIATE_DIR)',
-      '<(minizip_loc)',
       '<(emoji_suggestions_loc)',
       '<(submodules_loc)/crl/src',
     ],
diff --git a/Telegram/gyp/telegram_linux.gypi b/Telegram/gyp/telegram_linux.gypi
index cd6414461..1e1b14748 100644
--- a/Telegram/gyp/telegram_linux.gypi
+++ b/Telegram/gyp/telegram_linux.gypi
@@ -22,6 +22,7 @@
     'include_dirs': [
       '<!(rpm --eval "%{_includedir}")',
       '<!(rpm --eval "%{_includedir}")/ffmpeg',
+      '<!(rpm --eval "%{_includedir}")/minizip',
       '<!(rpm --eval "%{_includedir}")/opus',
       '<!(rpm --eval "%{_includedir}")/libtgvoip',
       '<!(rpm --eval "%{_includedir}")/guidelines-support-library',
@@ -38,6 +39,7 @@
       'swscale',
       'avutil',
       'z',
+      'minizip',
       'tgvoip',
       'lzma',
       'xxhash',
diff --git a/Telegram/gyp/telegram_sources.txt b/Telegram/gyp/telegram_sources.txt
index b17c4081f..bde05098a 100644
--- a/Telegram/gyp/telegram_sources.txt
+++ b/Telegram/gyp/telegram_sources.txt
@@ -760,13 +760,6 @@
 <(emoji_suggestions_loc)/emoji_suggestions.h
 
 platforms: !win
-<(minizip_loc)/crypt.h
-<(minizip_loc)/ioapi.c
-<(minizip_loc)/ioapi.h
-<(minizip_loc)/zip.c
-<(minizip_loc)/zip.h
-<(minizip_loc)/unzip.c
-<(minizip_loc)/unzip.h
 
 platforms: win
 <(res_loc)/winrc/Telegram.rc
-- 
2.17.2

